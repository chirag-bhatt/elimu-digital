(function(){"use strict";angular.module("gobel-app",["ngMaterialDatePicker"])})(),function(){"use strict";function n(n){function i(){n.loader=!0;$.ajax({method:"POST",url:"/api/exams/create",type:"json",data:{id:$("#UnitId").val(),model:n.exam},success:function(){n.loader=!1;yay("Exam scheduled successfully! Redirecting in a few...");setTimeout(function(){window.location="/exams"},1e3)},error:function(t){t.responseText?parseError(t.responseText):error(t.statusText);n.loader=!1}});n.loader=!1}function r(){n.loader=!0;n.exams=[];$.ajax({method:"GET",url:"/api/exams",success:function(t){if(t instanceof Array)if(t.length<1)info("You have no exams scheduled yet!");else for(var i=0;i<t.length;i++)n.$apply(function(){n.exams.push(t[i])})},error:function(n){n.responseText?parseError(n.responseText):error(n.statusText)}});n.loader=!1}function u(t){n.detailsLoader=!0;$.ajax({method:"GET",url:"/api/exams/"+t,success:function(t){n.$apply(function(){n.selectedExam=t});f()},error:function(n){n.responseText?parseError(n.responseText):error(n.statusText)}});n.detailsLoader=!1}function f(){$(".accordion-section-title").click(function(n){var i=$(this).attr("href");$(n.target).is(".active")?(t(),n.target.children[1].firstElementChild.className="fa fa-plus"):(t(),$(this).addClass("active"),n.target.children[1].firstElementChild.className="fa fa-minus",$(".accordion "+i).slideDown(300).addClass("open"));n.preventDefault()})}function t(){$(".accordion .accordion-section-title").removeClass("active");$(".accordion .accordion-section-content").slideUp(300).removeClass("open")}function e(t){n.loader=!0;n.exams=[];$.ajax({method:"GET",url:"/api/exams/unit/"+t,success:function(t){if(t instanceof Array)if(t.length<1)info("You have no exams scheduled yet!");else for(var i=0;i<t.length;i++)n.$apply(function(){n.exams.push(t[i])})},error:function(n){n.responseText?parseError(n.responseText):error(n.statusText)}});n.loader=!1}n.title="";n.exams=[];n.questions=[];n.question={Answers:[]};n.calendarDate=function(n){return moment().to(n)};n.minutesToExam=function(n){var t=new moment(n),i=new moment,r=moment.duration(t.diff(i)).as("minutes");return roundOff(r,2)};n.onInitExamIndex=function(){n.title="Examinations";r()};n.onInitUnitExams=function(n){e(n)};n.onAddQuestion=function(){n.question={Answers:[]};$("#addQuestionModal").modal("show")};n.onAddAnswer=function(){n.question.Text?(n.question.Answers.push(n.answer),n.answer={}):error("Type a question first before adding answer options.")};n.onExitQuestion=function(){n.question={Answers:[]};$("#addQuestionModal").modal("hide")};n.onRemoveQuestion=function(t){var i=n.questions.indexOf(t);n.questions.splice(i)};n.onSubmitQuestion=function(){if(n.question)if(n.question.Answers.length<1)error("Your question has no answers. Please add answer options");else{var t=parseFloat(n.question.Marks);n.question.Marks=t;n.questions.push(n.question);n.question={Answers:[]}}else error("No question written.")};n.onSubmitExam=function(){if(n.exam={},n.exam.Name=n.Name,n.exam.Date=moment(n.examDate).format(),n.exam.Start=moment(n.StartTime,"hh:mm a").format(),n.exam.End=moment(n.EndTime,"hh:mm a").format(),n.exam.Questions=n.questions,!n.Name){warning("Specify exam title/name. e.g Supplementary exam, Final year exam e.t.c");return}if(n.examDate===undefined){warning("Pick a date for this exam.");return}if(n.StartTime===undefined||n.EndTime===undefined){warning("Pick start and end time for this exam.");return}if(n.questions<1){warning("Exam has no questions. Add at-least one question to continue.");return}i()};n.onSelectExam=function(t){n.selectedExam=t;$("#examDetailsModal").modal("show");u(t.id)}}angular.module("gobel-app").controller("examCtrl",n);n.$inject=["$scope","$timeout","$interval"]}();